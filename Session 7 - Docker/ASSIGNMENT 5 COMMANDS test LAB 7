TERMINAL EXERCISE LAB 7 - DOCKER:

(vai in VSC per app.py e il file di DOCKERFILE da spiegare per l'assignment 5)

BUILD THE IMAGE:
docker build -t myserver . 
(-t stands for a tag and "." is for the context: 
"Docker, look for the DockerFile and all the necessary files in the current directory)

docker ps 

RUN THE DOCKER AND CHECK:
I specify to open only one port and to make the port mapping with the conventional: "port-on-host:port-on-container"
docker run -d -p 8080:5001 --name my-running-app myserver 
(-d stands for detatched, to run in background)
(otherwise I should have published all ports with -P or --publish-all in order to automatically configure the NAT of our machine)
(in that case we make a container port available to everyone (Docker host address known in that case)

docker ps     

TEST THE APP IN THE APP.PY FILE (JUST AN EXAMPLE OF DETERMINISTIC)
curl -X POST http://localhost:8080/response/v1/resources \
     -H "Content-Type: application/json" \
     -d '{"distr": "deterministic", "params": {"fixed": 3}, "task": "cpu"}'

FOR THE OPTIONAL PART:
(I USE A NEW DOCKER TO CREATE SO I HAVE TO REMOVE THE PREVIOUS ONE):

docker ps (to check the ID)
docker stop <ID>
docker rm <ID>
(I also thought to use commit (that saves a container's file changes or settings into a new image, 
but it's used only for debug emergencies such as a container that is failing.
Once I can let it work I use commit to not let it fail again)

I ENTER IN THE SITE AFTER THE FOLLOWING COMMAND:
docker login
(follow the link there)

I BUILD THE NEW IMAGE:
docker build -t myrestserver .   

docker tag myrestserver semplicementeria/myrestserver:v1 
docker push semplicementeria/myrestserver:v1

docker run -p 8080:5001 semplicementeria/myrestserver:v1
